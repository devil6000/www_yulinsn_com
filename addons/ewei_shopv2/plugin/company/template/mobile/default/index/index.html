{template '_header'}
<style type="text/css">
    .fui-page { background-color: #ffffff;}
    .header-color { background-color: #06b691;}
</style>
<script charset="utf-8" src="https://map.qq.com/api/js?v=2.exp&key=Y3UBZ-IQU6X-KBM46-ZLOWB-NCRKF-AOF43"></script>
<div class="fui-page fui-page-current">
    <div class="fui-header header-color">
        <div class="fui-header-left"><a class="back"></a></div>
        <div class="title" style="color: #ffffff;">企业地图</div>
        <div class="fui-header-right"></div>
    </div>
    <div class="fui-content">
        <div class="fui-page-map" id="container" style="width: 100%; height: 100%;"></div>
        <div class="fui-company-desc"></div>
    </div>
</div>
<script type="text/javascript">
    $(function () {
        var companys = {php echo json_encode($companys)};
        companys = eval(companys);

        var center = new qq.maps.LatLng(companys[0].lat, companys[0].lng);
        var map = new qq.maps.Map(document.getElementById('container'),{
            center: center,
            zoom: 13
        });

        var markes = new Array();
        $.each(companys, function (i,element) {
            var center = new qq.maps.LatLng(element.lat,element.lng);
            var marker = new qq.maps.Marker({
                position: center,
                map: map,
                //content: element.storename
            });
            var info = new qq.maps.InfoWindow({
                map: map
            });
            qq.maps.event.addListener(marker,'click',function () {
                info.open();
                info.setContent('<div style="display: flex; flex-direction: row;">' +
                    '<a href="' + element.url + '"><div style="flex: 1; width: 2rem; height: 2rem;"><img src="' + element.logo + '" style="width: 2rem; height: 2rem;" /></div>' +
                    '<div style="flex: 2; ">'+ element.storename + '</div></a>' +
                    '</div>');
                info.setPosition(center);
            });
            markes.push(marker);
        })
    })
</script>
{template '_footer'}